2025-07-22 19:55:39,482 - INFO - Starting VirusTotal checker
2025-07-22 19:55:39,483 - ERROR - Invalid JSON in log file
2025-07-22 19:55:39,484 - INFO - VT checker completed
2025-07-22 19:57:58,479 - INFO - Starting VirusTotal checker
2025-07-22 19:57:58,480 - ERROR - Invalid JSON in log file
2025-07-22 19:57:58,482 - INFO - VT checker completed
2025-07-22 20:09:28,906 - INFO - Starting VirusTotal checker
2025-07-22 20:09:31,077 - INFO - No entries found in server logs
2025-07-22 20:09:31,078 - INFO - VT checker completed
2025-07-22 20:21:33,765 - INFO - Starting VirusTotal checker
2025-07-22 20:21:35,850 - INFO - No entries found in server logs
2025-07-22 20:21:35,851 - INFO - VT checker completed
2025-07-22 20:31:54,218 - INFO - Starting VirusTotal checker
2025-07-22 20:31:56,649 - INFO - Loaded 2 log entries from server
2025-07-22 20:31:56,653 - INFO - Saved 2 results to logs/vt_results.json
2025-07-22 20:31:56,654 - INFO - Detection summary: 2 malicious files found
2025-07-22 20:31:56,667 - WARNING - - eicar.com (Detections: 66/76)
2025-07-22 20:31:56,668 - WARNING - - eicar.com (Detections: 66/76)
2025-07-22 20:31:56,669 - INFO - VT checker completed
2025-07-22 20:33:19,972 - INFO - Starting VirusTotal checker
2025-07-22 20:33:22,072 - INFO - Loaded 4 log entries from server
2025-07-22 20:33:22,074 - INFO - Checking VT for: cat.jpeg (90def42617fe42db0d55900b7e17d40fcd261044e325957c56af007a4361ae5c)
2025-07-22 20:33:38,523 - INFO - Checking VT for: cat.jpeg (90def42617fe42db0d55900b7e17d40fcd261044e325957c56af007a4361ae5c)
2025-07-22 20:33:54,674 - INFO - Saved 4 results to logs/vt_results.json
2025-07-22 20:33:54,675 - INFO - Detection summary: 2 malicious files found
2025-07-22 20:33:54,685 - WARNING - - eicar.com (Detections: 66/76)
2025-07-22 20:33:54,686 - WARNING - - eicar.com (Detections: 66/76)
2025-07-22 20:33:54,687 - INFO - VT checker completed
2025-08-21 23:34:52,545 - INFO - Starting VirusTotal checker
2025-08-21 23:34:56,667 - ERROR - Critical error: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /download_logs (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000002466A812E40>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))
Traceback (most recent call last):
  File "C:\Users\pc\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pc\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "C:\Users\pc\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\pc\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pc\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
  File "C:\Users\pc\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\urllib3\connection.py", line 445, in request
    self.endheaders()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\http\client.py", line 1333, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\http\client.py", line 1093, in _send_output
    self.send(msg)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.2800.0_x64__qbz5n2kfra8p0\Lib\http\client.py", line 1037, in send
    self.connect()
  File "C:\Users\pc\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\urllib3\connection.py", line 276, in connect
    self.sock = self._new_conn()
                ^^^^^^^^^^^^^^^^
  File "C:\Users\pc\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\urllib3\connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x000002466A812E40>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\pc\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\requests\adapters.py", line 667, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "C:\Users\pc\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "C:\Users\pc\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\urllib3\util\retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /download_logs (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000002466A812E40>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\pc\Desktop\EDR-2\detections_api\vt_checker.py", line 129, in main
    response = requests.get(LOG_ENDPOINT, timeout=30)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pc\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\requests\api.py", line 73, in get
    return request("get", url, params=params, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pc\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\requests\api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pc\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pc\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pc\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\requests\adapters.py", line 700, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=5000): Max retries exceeded with url: /download_logs (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000002466A812E40>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))
2025-08-21 23:34:56,872 - INFO - VT checker completed
2025-08-21 23:37:08,125 - INFO - Starting VirusTotal checker
2025-08-21 23:37:10,180 - INFO - Loaded 14 log entries from server
2025-08-21 23:37:10,182 - INFO - Checking VT for: keymapper-1.0-installer_KdE7-p1.exe (77440c39ac819d37ec2b96ef9f2606f59eb67b002f7bfd2cc828fd2a0144b98d)
2025-08-21 23:37:10,182 - INFO - Checking VT for: keymapper-1.0-installer_Ll-lWn1.exe (73ce5730dea408cc582c76d901d19df1fb8158a5309e0bd82a6f014bd749c896)
2025-08-21 23:37:10,182 - WARNING - Skipping entry without SHA256: Math Grade 10 (1).pdf
2025-08-21 23:37:10,183 - INFO - Checking VT for: keymapper-1.0-installer_M-LNQM1.exe (ffc910bdf3468999e419d80be850ac69c2bb3fa62a55c1633bc2eb681f4d1456)
2025-08-21 23:37:10,183 - INFO - Checking VT for: 271_AI Lect Notes.pdf (500d30d6de692d5442bce9fe7075bce7079231af25c08c4f0478c38e78c2160b)
2025-08-21 23:37:10,183 - INFO - Checking VT for: 271_AI Lect Notes.pdf (500d30d6de692d5442bce9fe7075bce7079231af25c08c4f0478c38e78c2160b)
2025-08-21 23:37:10,184 - WARNING - Skipping entry without SHA256: 271_AI Lect Notes.pdf
2025-08-21 23:37:10,184 - WARNING - Skipping entry without SHA256: eicar.com
2025-08-21 23:37:10,184 - WARNING - Skipping entry without SHA256: eicar.com
2025-08-21 23:37:10,184 - WARNING - Skipping entry without SHA256: eicar.com
2025-08-21 23:37:10,185 - WARNING - Skipping entry without SHA256: eicar.com
2025-08-21 23:37:10,186 - INFO - Saved 3 results to logs/vt_results.json
2025-08-21 23:37:10,188 - INFO - Detection summary: 3 malicious files found
2025-08-21 23:37:10,200 - WARNING - - eicar.com (Detections: 66/76)
2025-08-21 23:37:10,201 - WARNING - - eicar.com (Detections: 66/76)
2025-08-21 23:37:10,201 - WARNING - - eicar.com (Detections: 66/76)
2025-08-21 23:37:10,202 - INFO - VT checker completed
2025-08-21 23:38:12,847 - INFO - Starting VirusTotal checker
2025-08-21 23:38:14,884 - INFO - Loaded 14 log entries from server
2025-08-21 23:38:14,885 - INFO - Checking VT for: keymapper-1.0-installer_KdE7-p1.exe (77440c39ac819d37ec2b96ef9f2606f59eb67b002f7bfd2cc828fd2a0144b98d)
2025-08-21 23:38:14,887 - INFO - Checking VT for: keymapper-1.0-installer_Ll-lWn1.exe (73ce5730dea408cc582c76d901d19df1fb8158a5309e0bd82a6f014bd749c896)
2025-08-21 23:38:14,888 - WARNING - Skipping entry without SHA256: Math Grade 10 (1).pdf
2025-08-21 23:38:14,888 - INFO - Checking VT for: keymapper-1.0-installer_M-LNQM1.exe (ffc910bdf3468999e419d80be850ac69c2bb3fa62a55c1633bc2eb681f4d1456)
2025-08-21 23:38:14,888 - INFO - Checking VT for: 271_AI Lect Notes.pdf (500d30d6de692d5442bce9fe7075bce7079231af25c08c4f0478c38e78c2160b)
2025-08-21 23:38:14,889 - INFO - Checking VT for: 271_AI Lect Notes.pdf (500d30d6de692d5442bce9fe7075bce7079231af25c08c4f0478c38e78c2160b)
2025-08-21 23:38:14,889 - WARNING - Skipping entry without SHA256: 271_AI Lect Notes.pdf
2025-08-21 23:38:14,890 - WARNING - Skipping entry without SHA256: eicar.com
2025-08-21 23:38:14,890 - WARNING - Skipping entry without SHA256: eicar.com
2025-08-21 23:38:14,890 - WARNING - Skipping entry without SHA256: eicar.com
2025-08-21 23:38:14,891 - WARNING - Skipping entry without SHA256: eicar.com
2025-08-21 23:38:14,895 - INFO - Saved 3 results to logs/vt_results.json
2025-08-21 23:38:14,910 - INFO - Detection summary: 3 malicious files found
2025-08-21 23:38:14,917 - WARNING - - eicar.com (Detections: 66/76)
2025-08-21 23:38:14,917 - WARNING - - eicar.com (Detections: 66/76)
2025-08-21 23:38:14,918 - WARNING - - eicar.com (Detections: 66/76)
2025-08-21 23:38:14,918 - INFO - VT checker completed
2025-08-21 23:39:38,662 - INFO - Starting VirusTotal checker
2025-08-21 23:39:40,737 - INFO - Loaded 14 log entries from server
2025-08-21 23:39:40,739 - INFO - Checking VT for: keymapper-1.0-installer_KdE7-p1.exe (77440c39ac819d37ec2b96ef9f2606f59eb67b002f7bfd2cc828fd2a0144b98d)
2025-08-21 23:39:56,822 - INFO - Checking VT for: keymapper-1.0-installer_Ll-lWn1.exe (73ce5730dea408cc582c76d901d19df1fb8158a5309e0bd82a6f014bd749c896)
2025-08-21 23:40:12,627 - WARNING - Skipping entry without SHA256: Math Grade 10 (1).pdf
2025-08-21 23:40:12,627 - INFO - Checking VT for: keymapper-1.0-installer_M-LNQM1.exe (ffc910bdf3468999e419d80be850ac69c2bb3fa62a55c1633bc2eb681f4d1456)
2025-08-21 23:40:28,965 - INFO - Checking VT for: 271_AI Lect Notes.pdf (500d30d6de692d5442bce9fe7075bce7079231af25c08c4f0478c38e78c2160b)
2025-08-21 23:40:44,782 - INFO - Checking VT for: 271_AI Lect Notes.pdf (500d30d6de692d5442bce9fe7075bce7079231af25c08c4f0478c38e78c2160b)
2025-08-21 23:41:00,825 - WARNING - Skipping entry without SHA256: 271_AI Lect Notes.pdf
2025-08-21 23:41:00,826 - WARNING - Skipping entry without SHA256: eicar.com
2025-08-21 23:41:00,826 - WARNING - Skipping entry without SHA256: eicar.com
2025-08-21 23:41:00,827 - WARNING - Skipping entry without SHA256: eicar.com
2025-08-21 23:41:00,827 - WARNING - Skipping entry without SHA256: eicar.com
2025-08-21 23:41:00,831 - INFO - Saved 8 results to logs/vt_results.json
2025-08-21 23:41:00,832 - INFO - Detection summary: 6 malicious files found
2025-08-21 23:41:00,839 - WARNING - - keymapper-1.0-installer_KdE7-p1.exe (Detections: 10/76)
2025-08-21 23:41:00,840 - WARNING - - keymapper-1.0-installer_Ll-lWn1.exe (Detections: 13/76)
2025-08-21 23:41:00,840 - WARNING - - keymapper-1.0-installer_M-LNQM1.exe (Detections: 8/76)
2025-08-21 23:41:00,840 - WARNING - - eicar.com (Detections: 66/76)
2025-08-21 23:41:00,841 - WARNING - - eicar.com (Detections: 66/76)
2025-08-21 23:41:00,841 - WARNING - - eicar.com (Detections: 66/76)
2025-08-21 23:41:00,842 - INFO - VT checker completed
